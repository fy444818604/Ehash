<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>EHash</title>
		<link rel="stylesheet" type="text/css" href="plugins/layui-v2.5.6/layui/css/layui.css" />
		<link rel="stylesheet" type="text/css" href="./css/common.css" />
		<style type="text/css">
			.login-box {
				width: 560px;
				height: 600px;
				padding: 64px 113px 55px 113px;
				background-color: #FFFFFF;
				border-radius: 4px;
				box-shadow: 0px 2px 10px 0px rgba(0, 0, 0, 0.08);
				position: absolute;
				left: 50%;
				top: 48px;
				margin-left: -280px;
			}

			.auth-box {
				/* display: flex; */
				/* justify-content: center; */
				padding: 48px 0;
				position: relative;
			}

			.auth-title {
				margin-bottom: 40px;
				font-size: 32px;
				color: #222222;
				text-align: center;
			}

			.login-input-row {
				width: 100%;
				height: 48px;
				margin-bottom: 24px;
			}

			.get-password {
				margin-top: 8px;
				margin-bottom: 49px;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box
			}

			.verify-wrap {
				width: 350px;
				height: 40px;
				background-color: #e5e5e5;
				border: 1px solid #e0e0e0;
				margin: 5px auto;
				position: relative
			}

			.verify-wrap .drag-btn {
				position: absolute;
				left: -1px;
				top: -1px;
				width: 50px;
				height: 40px;
				background: #fff url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAiCAYAAAApkEs2AAAA/UlEQVRYhe3XLc9GYBjG8eN6dkdFIQuqoCiCbj6ob2CCIplRaJKqEHT3c/kAz66Xc/fLnvO3UY7N/jNmxDAMF77AQ57iOH53x5/GccTPuyNUcSg1DqXGodQ4lNr/CC3LEsuyaG8mrEKzLEPXdZjnWWszYRXq+z7yPMc0Tej7XnkzYf2Muq6LoiiwrivatsV1XUrby0Mlx3Huu7fvO5qmUd50kL31QgijTdXD+gq/zvNEVVXwPA9pmipvOqxDj+O4Q4IgQJIkypsuq9Bt21DXNaIoug/VzYRVqHw55J0Kw1BrMyHkXyj/3BHiUGocSo1DqXEota8Jvb/18hP16Z7qL3h/w53n4AAAAABJRU5ErkJggg==) no-repeat center center;
				background-size: 100% 100%;
				z-index: 2;
				cursor: move;
			}

			.verify-wrap .suc-drag-btn {
				background: #fff url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAiCAYAAAApkEs2AAACA0lEQVRYhe2Y2yuDYRzHv7PJYc5zKspYSRMymStXu5NCs5W4csEfwJ+gSA53csg1F4R/gSu0OcWSmNIQkfMcEvu9tdpY79793leo91Nbbft993x6nj2/52kal8v1gX+Ajp4sFstve4jidrsR99sSUlFFlUYVVRpVVGl0SnyJ934VaxczOLpdwd3bufBeWnw+StLrYc1tQ3FqnewxZIk+vz9g7rAHO9dL3z67efXBfTkrPCqymtBqGkaiNoU9FnvpSXJyzx5R8itUQ7WU4cIWnT/qhe9xS3I91VKGC0uUfpPbV4uSajUhQ1CGshxYorRxpGDObECf1Ysm40DM2a+wNhPt7mhUZzvhMI1Aq9HBkFgUUzYSrBkNtiDCkGBES/Eg8pLKwiSdplFB8uRhEzMH3RGzsSC7j9oKe1CT4wi0oEZMeRzITy4XJOM0WkFy2uOE//1O7jA8UWrm1CeJ5dMxlGXYoI/PQrd5AQlavagkZTmwlt4UOHGCnPs9wkw+vl0jSZcWdSZDsz8uas1tD3t99rSL8b0W3Lz4cHy/LrrctYEjlQNr6Y2ptag0NIf10gv/Pvo3akRzlOGe++yTyV4yhAJ9leR6qqUMF7YoXTC6zPPChSMaVEO1ci4lstoTDdxROhE4Fjv/9jUvCIkoISPGv7nhq6JKo4oqjSqqNEIfpf8f/zqf+36643RPeo8AAAAASUVORK5CYII=) no-repeat center center;
				background-size: 100% 100%
			}

			.verify-wrap .drag-progress {
				position: absolute;
				left: 0;
				top: -1px;
				height: 40px;
				border-top: 1px solid #7ac23c;
				border-top: 1px solid #7ac23c;
				width: 0;
				background-color: #7ac23c;
				color: #fff;
				font-size: 18px;
				text-align: center;
				line-height: 40px
			}

			.verify-wrap .fix-tips,
			.verify-msg {
				width: 100%;
				position: absolute;
				right: 0;
				left: 1px;
				height: 100%;
				color: #51555c;
				z-index: 1;
				line-height: 38px;
				font-size: 12px;
				text-align: center
			}

			.verify-wrap .verify-msg {
				background-color: #7ac23c;
				color: #fff;
				display: none
			}
			
			.verify-wrap{
				width: 334px;
			}
			
			.main-body{
				min-height: calc(100vh - 200px);
			}
		</style>
	</head>
	<body>
		<script type="text/javascript" src="./js/header.js"></script>
		<div class="main-body">
			<div class="auth-box layui-form" v-cloak>
				<div style="height: 600px;"></div>
				<div class="login-box" v-show="type == 1">
					<div class="auth-title">欢迎登录</div>
					<div class="login-input-row">
						<input type="text" name="title" v-model="userName" required lay-verify="required" placeholder="手机号/邮箱" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<div class="verify-wrap"></div>
					</div>
					<div class="login-input-row">
						<input type="password" name="title" v-model="pass" required lay-verify="required" placeholder="密码" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<button type="button" @click="login" class="layui-btn layui-btn-fluid bg582">登录</button>
					</div>
					<div class="flex-between get-password">
						<div>
							<input type="checkbox" name="" title="记住密码" lay-skin="primary" checked>
						</div>
						<div class="c582 cursor">忘记密码</div>
					</div>
					<div class="flex-center">
						<div class="c999">还没有账号?</div>
						<div class="c582 cursor" @click="type = 2">立即注册</div>
					</div>
				</div>
				<div class="login-box" v-show="type == 2">
					<div class="auth-title">手机快速注册</div>
					<div class="login-input-row">
						<input type="text" name="title" v-model="phone" required lay-verify="required" placeholder="手机号" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<div class="verify-wrap1"></div>
					</div>
					<div class="login-input-row flex-between">
						<input type="text" v-model="verificationCode" name="title" required lay-verify="required" placeholder="验证码" autocomplete="off" class="layui-input">
						<button type="button" class="layui-btn bg582" style="margin-left: 12px;" @click="getCode" :disabled="phoneMsg != '发送验证码'">{{phoneMsg}}</button>
					</div>
					<div class="login-input-row">
						<button type="button" class="layui-btn layui-btn-fluid bg582" @click="phoneCode">下一步</button>
					</div>
					<div class="get-password">
						<div class="c582 cursor" @click="type = 4">邮箱注册</div>
					</div>
					<div class="flex-center">
						<div class="c999">已有账号?</div>
						<div class="c582 cursor" @click="type = 1">登录</div>
					</div>
				</div>
				<div class="login-box" v-show="type == 3">
					<div class="auth-title">手机快速注册</div>
					<div class="login-input-row">
						<input type="password" v-model="pass1" name="title" required lay-verify="required" placeholder="密码" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<input type="password" v-model="pass2" name="title" required lay-verify="required" placeholder="重复密码" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<button type="button" class="layui-btn layui-btn-fluid bg582" @click="setPass">完成</button>
					</div>
					<div class="get-password">
						<div class="c582 cursor" @click="type = 4">邮箱注册</div>
					</div>
					<div class="flex-center">
						<div class="c999">已有账号?</div>
						<div class="c582 cursor"  @click="type = 1">登录</div>
					</div>
				</div>
				<div class="login-box" v-show="type == 4">
					<div class="auth-title">邮箱注册</div>
					<div class="login-input-row">
						<input type="text" name="title" v-model="email" required lay-verify="required" placeholder="邮箱" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<div class="verify-wrap2"></div>
					</div>
					<div class="login-input-row flex-between">
						<input type="text" name="title" v-model="verificationCode1" required lay-verify="required" placeholder="验证码" autocomplete="off" class="layui-input">
						<button type="button" class="layui-btn bg582" style="margin-left: 12px;" @click="getCode1" :disabled="emailMsg != '发送验证码'">{{emailMsg}}</button>
					</div>
					<div class="login-input-row">
						<button type="button" class="layui-btn layui-btn-fluid bg582" @click="emailCode">下一步</button>
					</div>
					<div class="get-password">
						<div class="c582 cursor" @click="type = 2">手机注册</div>
					</div>
					<div class="flex-center">
						<div class="c999">已有账号?</div>
						<div class="c582 cursor"  @click="type = 1">登录</div>
					</div>
				</div>
				<div class="login-box" v-show="type == 5">
					<div class="auth-title">邮箱注册</div>
					<div class="login-input-row">
						<input type="password" v-model="pass1" name="title" required lay-verify="required" placeholder="密码" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<input type="password" v-model="pass2" name="title" required lay-verify="required" placeholder="重复密码" autocomplete="off" class="layui-input">
					</div>
					<div class="login-input-row">
						<button type="button" class="layui-btn layui-btn-fluid bg582" @click="setPass">完成</button>
					</div>
					<div class="get-password">
						<div class="c582 cursor" @click="type = 2">手机注册</div>
					</div>
					<div class="flex-center">
						<div class="c999">已有账号?</div>
						<div class="c582 cursor"  @click="type = 1">登录</div>
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="./js/footer.js"></script>
	</body>
	<script type="text/javascript" src="./js/jquery.min.js"></script>
	<script src="js/jwt.js" type="text/javascript" charset="utf-8"></script>
	<script src="./plugins/layui-v2.5.6/layui/layui.js" type="text/javascript" charset="utf-8"></script>
	<script src="plugins/Sliding_Validation_Gu/Sliding_Validation_Gu.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/http.js" type="text/javascript" charset="utf-8"></script>
	<script src="./js/vue.min.js"></script>
	<script type="text/javascript">
		var head = new Vue({
			el:'.header-cont',
			data:{
				userName1:''
			},
			methods:{
				getUser(){
					GET({},'/user/get_own_info', res => {
						if(res.data.userEmail != ''){
							this.userName1 = res.data.userEmail
						}else{
							this.userName1 = res.data.userTel
						}
					})
				}
			},
			created() {
				this.getUser()
			},
			mounted() {
				
			}
		})
		let vm = new Vue({
			el: '.auth-box',
			data: {
				type: 1,
				userName:'',
				pass:'',
				phone:'',
				verificationCode:'',
				email:'',
				verificationCode1:'',
				key:'',
				pass1:'',
				pass2:'',
				loginSu:false,
				phoneSu:false,
				emailSu:false,
				phoneMsg:'发送验证码',
				emailMsg:'发送验证码'
			},
			methods:{
				login() {
					if(this.loginSu){
						let data = {
							userName:this.userName,
							passWd: this.pass
						}
						POST(data,'/pub/in',res => {
							window.localStorage.setItem('Authorization',res.data)
							window.location.href = 'person.html'
						})
					}else{
						layer.msg('请先滑动验证')
					}
				},
				phoneCode() {
					POST({tel:this.phone,verificationCode:this.verificationCode},`/pub/tel_reg`, res => {
						this.key = res.data
						this.type = 3
					})
				},
				emailCode() {
					POST({email:this.email,verificationCode:this.verificationCode1},'i/pub/email_reg', res => {
						
					})
				},
				
				getCode() {
					let _this = this;
					if(this.phoneSu){
						POST({address:this.phone},'/pub/send_v_code', res => {
							_this.phoneMsg = 60
							var time = setInterval(() => {
								_this.phoneMsg = _this.phoneMsg - 1
								console.log(_this.phoneMsg)
								if(_this.phoneMsg == 0){
									clearInterval(time)
									_this.phoneMsg = '发送验证码'
								}
							},1000)
						})
					}else{
						layer.msg('请先滑动验证')
					}
				},
				getCode1() {
					let _this = this;
					if(this.emailSu){
						POST({address:this.email},'/pub/send_v_code', res => {
							_this.emailMsg = 60
							var time = setInterval(() => {
								_this.emailMsg = _this.emailMsg - 1
								console.log(_this.emailMsg)
								if(_this.emailMsg == 0){
									clearInterval(time)
									_this.emailMsg = '发送验证码'
								}
							},1000)
						})
					}else{
						layer.msg('请先滑动验证')
					}
				},
				setPass() {
					if(this.pass1 == this.pass2){
						POST({passWord:this.pass2,key:this.key},`/pub/reset_pwd`, res => {
							if(res.code == 200){
								layer.msg('注册成功')
								this.type = 1
							}
						})
					}else{
						layer.msg('密码不一致')
					}
				}
			},
			watch:{
				type() {
					
				}
			},
			created() {
				this.type = window.location.href.split('type=')[1]
			},
			mounted() {
				layui.use(['layer', 'form'], function() {
					var layer = layui.layer,
						form = layui.form;

				});
			}
		})
		var sliding_validation = SlidingValidation.create($('.verify-wrap'),{
			success_url_icon: "./plugins/Sliding_Validation_Gu/sliding_block_image/ok.png",
			default_url_icon: "./plugins/Sliding_Validation_Gu/sliding_block_image/right-arrow.png",
			slide_block_wrapper_width: "334px"
		},function(){
			vm.loginSu = true
		}); 
		var sliding_validation = SlidingValidation.create($('.verify-wrap1'),{
			success_url_icon: "./plugins/Sliding_Validation_Gu/sliding_block_image/ok.png",
			default_url_icon: "./plugins/Sliding_Validation_Gu/sliding_block_image/right-arrow.png",
			slide_block_wrapper_width: "334px"
		},function(){
			vm.phoneSu = true
		});
		 var sliding_validation = SlidingValidation.create($('.verify-wrap2'),{
		 	success_url_icon: "./plugins/Sliding_Validation_Gu/sliding_block_image/ok.png",
		 	default_url_icon: "./plugins/Sliding_Validation_Gu/sliding_block_image/right-arrow.png",
		 	slide_block_wrapper_width: "334px"
		 },function(){
			 vm.emailSu = true
		 }); 
		 
		 $('.login-out').click(() => {
		 	console.log(123)
		 	let name = $('.head-user').text()
		 	GET({
		 		userName: name
		 	}, '/pub/out', res => {
		 		if (res.code == 200) {
		 			window.localStorage.removeItem('Authorization')
		 			window.location.href = 'index.html'
		 		}
		 	})
		 })
	</script>
</html>
